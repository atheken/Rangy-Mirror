<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title>DOM Range</title>
    <script type="text/javascript" src="../src/js/log4javascript.js"></script>
    <script type="text/javascript">
        log4javascript.getRootLogger().addAppender(new log4javascript.InPageAppender());
        var log = log4javascript.getRootLogger();

/*        log4javascript.addRenderer(function(o) {
            return typeof o.nodeType != "undefined";
        }, function(o) {
            if (!o) { return "No node"; }
            return ("data" in o) ? '"' + o.data + '"' : o.nodeName;
        });*/
    </script>

    <script type="text/javascript" src="../src/js/core.js"></script>
    <script type="text/javascript" src="../src/js/dom.js"></script>
    <script type="text/javascript" src="../src/js/domrange.js"></script>
    <script type="text/javascript" src="../src/js/wrappedrange.js"></script>
    <script type="text/javascript" src="../src/js/wrappedselection.js"></script>
    <script type="text/javascript">
        function r() {
            var sel = rangy.getSelection();
            return sel.getRangeAt(0);
        }

        function g(id) {
            return document.getElementById(id);
        }

        function showFragment(frag) {
            g('ph').innerHTML = "";
            g('ph').appendChild(frag);
            log.warn(g('ph').innerHTML);
        }

        function reselect() {
            var sel = rangy.getSelection();
            var range = sel.getRangeAt(0);
            sel.removeAllRanges();
            sel.addRange(range);
        }
    </script>
</head>
<body>
<input type="button" value="reselect" onclick="reselect(); g('ed').focus()">
<input type="button" value="get text" onclick="log.warn('Selected text: |' + rangy.getSelection() + '|');">
<input type="button" value="delete" onclick="r().deleteContents()">
<input type="button" value="extract" onclick="showFragment(r().extractContents())">
<input type="button" value="clone" onclick="showFragment(r().cloneContents())">
<input type="button" value="surround" onclick="var n = document.createElement('span'); n.style.backgroundColor = 'pink'; try { r().surroundContents(n) } catch (ex) {alert(ex);}">
<input type="button" value="delete selection" onclick="rangy.getSelection().deleteFromDocument(); g('ed').focus()">
<br>

<div style="border: solid green 1px; padding: 2px">
    <p>A paragraph with <b>bold text</b> with <i>italic</i> words plus <b>some using <i>both</i></b>.</p>
    <p>A paragraph with <b>bold text</b> with <i>italic</i> words plus <b>some using <i>both</i></b>.<br>
        A paragraph with <b>bold text</b> with <i>italic</i> words plus <b>some using <i>both</i></b>.</p>
<textarea rows="5" cols="60">
    Some text and some more text and some more text
</textarea>
    <pre>
Some preformatted text
Wonder how it'll do

with this, plus some line breaks


</pre>

</div>

<div style="border: solid green 1px; padding: 2px" contenteditable="true" id="ed" onkeydown="if (event.keyCode==40 && event.ctrlKey){reselect(); g('ed').focus(); return false;}">
    <p><script>document.write("A paragraph\r\nwith ")</script><b>bold text</b> with <i>italic</i> words plus <b>some using <i>both</i></b>.</p>
    <p>A paragraph with <b>bold text</b> with <i>italic</i> words plus <b>some using <i>both</i></b>.<br>
        A paragraph with <b>bold text</b> with <i>italic</i> words plus <b>some using <i>both</i></b>.</p>

    <pre>
Some preformatted <script>document.write("text\n\tWonder ")</script>how it'll do

with this, plus some line breaks


</pre>

</div>
<div id="ph" style="border: solid blue 1px; padding: 2px"></div>

</body></html>